#!/usr/bin/python3
import socket
import datetime
import threading
import time
import argparse
import ipaddress
from termcolor import colored

PORTS = [80,23,443,21,22,25,3389,110,445,139,143,53,135,3306,8080,1723,111,995,993,5900,1025,587,199,1720,465,548,113,81,6001,10000,514,5060,179,1026,2000,8443,8000,32768,554,26,1433,49152,2001,515,8008,49154,1027,5666,646,5000,5631,631,49153,8081,2049,88,79,5800,106,2121,1110,49155,6000,513,990,5357,427,49156,543,544,144,7,389,8009,3128,444,9999,5009,7070,5190,3000,5432,3986,1900,13,1029,9,6646,5051,49157,1028,873,1755,2717,4899,9100,119,37,1000,3001,5001,82,10010,1030,9090,2107,1024,2103,6004,1801,5050,19,8031,1041,255,3703,2967,1065,1064,1056,1054,1053,1049,1048,17,808,3689,1031,1071,1044,5901,9102,100,9000,8010,5120,4001,2869,1039,2105,636,1038,2601,7000,1,1069,1066,625,311,280,254,4000,5003,1761,2002,2005,1998,1032,1050,6112,3690,1521,2161,6002,1080,2401,902,4045,7937,787,1058,2383,32771,1059,1040,1033,50000,5555,10001,1494,593,3,2301,7938,3268,1234,1022,9001,8002,1074,1037,1036,1035,464,6666,497,2003,1935,6543,24,1352,3269,1111,500,407,20,2006,3260,15000,1218,1034,4444,264,33,2004,42510,1042,999,3052,1023,222,1068,888,7100,563,1717,992,32770,2008,7001,32772,8082,2007,5550,5801,512,2009,1043,7019,50001,2701,1700,4662,2065,42,2010,9535,3333,2602,161,5100,5002,4002,2604,9595,9594,9593,9415,8701,8652,8651,8194,8193,8192,8089,6789,65389,65000,64680,64623,6059,55600,55555,52869,5226,5225,4443,35500,33354,3283,32769,2702,23502,20828,16993,16992,1311,1062,1060,1055,1052,1051,1047,13782,1067,5902,366,9050,85,5500,1002,8085,5431,51103,49999,45100,1864,1863,10243,49,90,6667,6881,27000,1503,8021,340,1500,9071,8899,8088,5566,2222,9876,9101,6005,5102,32774,32773,1501,5679,163,648,1666,146,901,83,9207,8084,8083,8001,5214,5004,3476,14238,912,30,12345,2605,2030,6,541,8007,4,3005,1248,880,306,2500,9009,8291,52822,4242,2525,1097,1088,1086,900,6101,7200,2809,987,800,32775,211,12000,1083,705,711,20005,6969,13783,9968,9900,9618,9503,9502,9500,9485,9290,9220,9080,9011,9010,9002,8994,8873,8649,8600,8402,8400,8333,8222,8181,8087,8086,7911,7778,7777,7741,7627,7625,7106,6901,6788,6580,65129,6389,63331,6156,6129,6123,60020,5989,5988,5987,5962,5961,5960,5959,5925,5911,5910,5877,5825,5810,58080,57294,5718,5633,5414,5269,5222,50800,5030,50006,50003,49160,49159,49158,48080,4449,4129,4126,40193,4003,3998,3827,3801,3784,3766,3659,3580,3551,34573,34572,34571,3404,33899,3367,3351,3325,3323,3301,3300,32782,32781,3211,31038,3071,30718,3031,3017,30000,2875,28201,2811,27715,2718,2607,25734,2492,24800,2399,2381,22939,2260,2190,2160,21571,2144,2135,2119,2100,20222,20221,20031,20000,19842,19801,1947,19101,1840,17988,1783,1718,1687,16018,16016,16001,15660,15003,15002,14442,14000,13456,1310,1272,11967,1169,1148,11110,1108,1107,1106,1104,1100,1099,1098,1096,1094,1093,1085,1082,1081,1079,1078,1077,1075,1073,1072,1070,1063,10629,10628,10626,10621,1061,10617,10616,1057,10566,1046,1045,10025,10024,10012,10002,89,691,32776,212,2020,1999,1001,7002,6003,50002,2998,898,5510,3372,32,2033,99,749,5903,425,7007,6502,6106,5405,458,43,13722,9998,9944,9943,9877,9666,9110,9091,8654,8500,8254,8180,8100,8090,8011,7512,7443,7435,7402,7103,62078,61900,61532,5963,5922,5915,5904,5859,5822,56738,55055,5298,5280,5200,51493,50636,5054,50389,49175,49165,49163,4446,4111,4006,3995,3918,3880,3871,3851,3828,3737,3546,3493,3371,3370,3369,32784,3261,3077,3030,3011,27355,27353,27352,2522,24444,2251,2191,2179,2126,19780,19315,19283,18988,1782,16012,1580,15742,1334,1296,1247,1186,1183,1152,1124,1089,1087,10778,10004,9040,32779,32777,1021,700,666,616,32778,2021,84,5802,545,49400,4321,38292,2040,1524,1112,32780,3006,2111,2048,1600,1084,9111,6699,6547,2638,16080,801,720,667,6007,5560,555,2106,2034,1533,1443,9917,9898,9878,9575,9418,9200,9099,9081,9003,8800,8383,8300,8292,8290,8200,8099,8093,8045,8042,8022,7999,7921,7920,7800,7676,7496,7025,6839,6792,6779,6692,6689,6567,6566,6565,6510,6100,60443,6025,5952,5950,5907,5906,5862,5850,5815,5811,57797,5730,5678,56737,5544,55056,5440,54328,54045,52848,52673,5221,5087,5080,5061,50500,5033,50300,49176,49167,49161,4900,4848,4567,4550,44501,4445,44176,4279,41511,40911,4005,4004,3971,3945,3920,3914,3905,3889,3878,3869,3826,3814,3809,3800,3527,3517,3390,3324,3322,32785,32783,3221,3168,30951,3003,2909,27356,2725,26214,2608,25735,2394,2393,2323,19350,1862,18101,18040,17877,16113,16000,15004,14441,1271,12265,12174,1201,1199,1175,1151,1138,1131,1122,1119,1117,1114,11111,1091,1090,10215,10180,10009,10003,981,777,722,714,70,6346,617,4998,4224,417,2022,1009,765,668,5999,524,301,2041,1076,10082,7004,6009,44443,4343,416,259,2068,2038,1984,1434,1417,1007,911,9103,726,7201,687,6006,4125,2046,2035,1461,109,1010,903,683,6669,6668,481,2047,2043,2013,1455,125,1011,9929,843,783,5998,44442,406,31337,256,2045,2042,9988,9941,9914,9815,9673,9643,9621,9600,9501,9444,9443,9409,9198,9197,9191,9098,8996,8987,8877,8766,8765,8686,8676,8675,8648,8540,8481,8385,8294,8293,8189,8098,8097,8095,8050,8019,8016,8015,7929,7913,7900,7878,7770,7749,7744,7725,7438,7281,7278,7272,7241,7123,7080,7051,7050,7024,6896,6732,6711,6600,6550,65310,6520,6504,6500,6481,6247,6203,61613,6068,60642,6060,6051,60146,60123,5981,5968,5940,5938,59202,59201,59200,5918,5914,59110,5909,5905,5899,58838,5869,5868,58632,58630,5823,5818,5812,5807,58002,58001,57665,55576,55020,5501,5353,53535,5339,53314,53313,53211,52853,52851,52850,52849,52847,5279,52735,52710,52660,5242,5223,5212,5151,51413,51191,5081,5074,5063,5040,50050,4949,49401,49236,49195,49186,49171,49168,49164,4875,47544,46996,4658,46200,4600,4555,44709,4430,4252,4200,4164,41523,4147,4143,41064,4096,40811,4080,4040,4009,40000,3994,3993,3990,3981,3972,3969,3968,39659,3963,3957,3944,3941,39376,3931,3929,3916,39136,3907,3888,3872,3870,3863,3859,3853,3852,3849,3848,3846,3824,3820,38188,38185,3808,3792,37839,3731,3700,3697,3684,35513,3514,3410,3400,3376,33554,33453,3307,3304,32835,32822,32816,32803,32792,32791,31727,3162,3119,30704,3050,3013,3007,30005,29831,2968,29672,2920,2910,28211,2800,27357,2710,26470,26000,2557,2382,23796,2366,23052,2288,22222,2200,2196,21792,2170,2099,20002,19900,1974,1972,1971,1914,1875,1839,18264,1812,1805,18018,17595,1721,1719,1688,16851,16800,16705,1658,1641,1594,1583,1556,15402,15001,13724,1328,1322,1309,1301,1300,1287,1277,1259,12452,1244,12380,1236,1233,12262,12215,1217,1216,1213,12059,12021,12006,1198,1192,1187,1185,1174,1166,1165,1164,1163,1154,1149,1147,1145,1141,1137,1132,1130,1126,1123,1121,1113,1105,1102,1095,1092,10873,10160,10058,10034,10023,10022,10011,10008,930,913,803,780,725,710,701,639,623,6222,5680,502,4559,2501,2241,2232,2012,1347,1220,1109,1103,10005,9992,953,931,874,86,856,8118,540,5010,475,447,442,441,419,27,250,2044,18000,1270,123,1222,1158,102,980,9152,87,829,713,709,7003,6103,6008,5803,57,55,556,5520,3299,3025,2628,251,2433,223,210,1550,1212,1013,1008,10083,943,904,840,825,792,77,748,732,7010,684,674,657,610,557,523,4333,333,220,2067,2011,157,1547,1526,1516,1351,1350,127,1241,1020,1006,998,996,971,969,905,862,846,839,823,822,795,790,786,782,778,757,731,730,729,6662,660,659,655,6050,602,600,3632,3456,3399,2903,257,225,2201,2025,1522,1357,1353,1015,1014,1012,98,928,924,922,921,918,878,864,859,806,805,802,758,754,740,728,715,690,669,6670,641,621,606,6017,59,5011,44334,411,3999,388,38037,2600,252,2112,1525,1414,1413,1337,12346,1127,1005,1004,9995,9990,9979,9975,9971,9950,9919,9915,9912,9911,9910,9909,9908,9901,9875,9844,9830,9826,9825,9823,9814,9812,9777,9745,9700,9694,9683,9680,9679,9674,9667,9665,9661,9654,9648,9628,9620,9619,9616,9613,9592,9583,9527,9513,9493,9478,9464,9454,9400,9364,9351,9343,9333,9300,9287,9211,9210,9202,9183,9170,9161,9160,9133,9131,9130,9128,9125,9084,9065,9061,9044,9037,9022,9021,9020,9013,9005,9004,8999,8980,8954,8925,8900,8898,8887,8883,8882,8880,8879,8878,8865,8843,8801,8798,8790,8772,8756,8752,8736,8680,8673,8658,8655,8644,8640,8621,8601,8562,8539,8531,8530,8515,8484,8479,8477,8474,8472,8471,8470,8455,8454,8453,8452,8451,8445,8409,8403,8401,8339,8308,8295,8282,8273,8268,8255,8248,8245,8232,8202,8201,8144,8133,8116,8110,8092,8064,8060,8052,8037,8029,8025,8023,8018,8014,8006,8005,8003,7998,7975,7895,7854,7853,7852,7830,7813,7789,7788,7780,7772,7771,7688,7685,7654,7637,7628,7600,7555,7553,7501,7500,7456,7451,7400,7345,7325,7320,7300,7231,7218,7184,7121,7119,7104,7102,7101,7099,7092,7072,7071,7068,7067,7043,7033,6973,6972,6956,6942,6922,6920,6897,6888,6877,6780,6734,6725,6710,6709,6650,6647,6644,6628,6619,6606,6579,65514,65488,6535,65311,65048,6503,64890,64727,64726,64551,64507,64438,64320,6412,64127,64080,63803,6379,63675,6350,6349,63423,6324,6323,63156,6310,63105,6309,62866,6274,6273,62674,6259,62570,6251,62519,6250,62312,62188,62080,62042,62006,61942,61851,61827,61734,61722,61669,6161,61617,61616,61516,61473,61402,6126,6120,61170,61169,6115,61159,6113,60989,6091,6090,6085,60794,60789,60783,60782,6077,60753,60743,60728,60713,6067,6065,6063,6062,60628,60621,60612,60579,6055,60544,6052,60504,60492,60485,60403,60401,60377,6030,60279,60243,60227,6021,60177,6015,60111,6010,60086,60055,60003,60002,60000,59987,5986,5985,59841,59829,59810,59778,5975,5974,5971,5969,59684,5966,5958,59565,5954,5953,59525,59510,59509,59504,5949,59499,5948,5945,5939,5936,5934,59340,5931,5927,5926,5924,5923,59239,5921,5920,59191,5917,59160,59149,5912,59122,59107,5908,59087,58991,58970,58908,5888,5887,5881,5878,5875,5874,58721,5871,58699,58634,58622,58610,5860,5858,58570,58562,5854,5853,5852,5849,58498,5848,58468,5845,58456,58446,58430,5840,5839,5838,58374,5836,5834,5831,58310,58305,5827,5826,58252,5824,5821,5820,5817,58164,5814,58109,58107,5808,58072,5806,5804,57999,57988,57928,57923,57896,57891,57733,57730,57702,57681,57678,57576,57479,57398,57387,5737,57352,57350,5734,57347,57335,5732,57325,5723,5722,5721,57123,5711,57103,57020,56975,56973,56827,56822,56810,5672,56725,56723,56681,5667,56668,5665,56591,56535,56507,56293,56259,5622,5621,5620,5612,5611,56055,56016,55948,55910,55907,55901,5581,5580,55781,55773,55758,55721,55684,55652,55635,5557,55579,55569,55568,55556,5554,5553,5552,55527,55479,55426,55400,55382,55350,55312,55227,55187,55183,5502,55000,54991,54987,54907,54873,5475,54741,5473,54722,54688,54658,54605,5458,5457,54551,54514,5444,5442,5441,5433,54323,54321,54276,54263,5423,54235,54127,54101,54075,53958,53910,53852,53827,53782,5377,53742,5370,53690,53656,53639,53633,53491,5347,53469,53460,53370,53361,53319,53240,53212,53189,53178,53085,52948,5291,52893,52675,52665,5261,5259,52573,5252,5250,52506,52477,52391,5235,5234,5233,52262,52237,52230,52226,52225,5219,52173,52071,52046,5202,52025,5201,52003,52002,52001,52000,51965,51961,51909,51906,51809,51800,51772,51771,51658,51582,5152,51515,51488,51485,51484,5147,51460,51423,5137,51366,51351,51343,5133,51300,5125,51240,51235,51234,51233,5122,5121,5114,51139,5111,51118,51067,51037,51020,51011,50997,5098,5096,5095,50945,5090,50903,5088,50887,50854,50849,50836,50835,50834,50833,50831,50815,50809,50787,50733,5070,50692,5066,50585,50577,50576,5055,50545,5053,5052,50529,50513,50356,50277,50258,50246,5023,50224,5021,5020,50205,50202,50198,50189,5017,5016,5015,5014,5013,5012,50101,5005,50040,50019,50016,4999,49927,49803,49765,49762,49751,49678,49603,49597,49522,49521,49520,49519,49500,49498,49452,49398,49372,49352,4931,49302,49275,49241,49235,49232,49228,49216,49213,49211,49204,49203,49202,49201,49197,49196,49191,49190,49189,49179,49173,49172,49170,49169,49166,49132,4912,49048,4903,49002,48973,48967,48966,48925,4881,48813,48783,4877,4876,48682,48648,48631,48619,4860,4859,48434,48356,4819,48167,48153,48127,48083,48067,4800,48009,47969,47966,4793,47860,47858,47850,47806,4778,47777,4771,4770,47700,4767,47634,47624,4760,47595,47581,47567,4745,47448,47372,47348,47267,47197,4713,4712,47119,47029,47012,4700,46992,4689,4687,46813,4665,46593,4649,4644,46436,46418,46372,46310,46182,46171,46115,4609,4606,46069,46034,4602,4601,4599,45960,45864,45777,4570,45697,45624,45602,4558,45463,4545,45438,45413,4534,4530,45226,45220,4517,4516,45164,45136,45050,45038,44981,44965,4476,4471,44711,44704,4464,44628,44616,4454,44541,44505,4447,44479,44431,4442,44410,44380,4433,44200,4418,4415,4414,44119,44101,4407,4401,44004,4388,43868,4384,43823,4376,4375,4374,43734,4369,43690,43654,4358,4357,4356,4355,4342,43425,4328,4325,43242,43231,43212,43143,43139,43103,4302,43027,43018,4300,43002,43000,42990,4298,4297,4294,42906,42735,42685,42679,42675,42632,4262,42590,42575,42560,42559,42452,42449,4243,4234,42322,42276,42251,4220,42158,42127,4206,42035,42001,4192,4190,41808,41795,41794,41773,4174,41632,4161,4158,41551,41442,4141,41398,4135,41348,41345,41342,41318,41281,41250,4121,4120,4119,4118,41142,4113,4112,41123,4101,4100,40951,4090,4087,40834,40812,40754,40732,40712,4065,40628,40614,4058,4056,40513,40489,40457,40400,4039,40393,4036,4035,40306,4029,4025,4024,4022,4020,4016,4010,4007,40011,40005,40003,40002,40001,3997,3996,3992,3991,39917,3989,39895,39883,39869,3983,3982,3980,3979,39795,39774,39763,3975,39732,3967,3964,39630,3962,3961,3956,3952,3949,3948,39489,39482,3946,3943,39433,3940,39380,3937,3936,3935,3930,39293,3928,39265,3923,3922,3919,3915,3913,3911,39117,3909,3908,3906,39067,3904,3902,3901,3899,3897,38936,3890,3882,38805,3879,38780,3876,38764,38761,3868,3860,38570,3856,38561,38546,3850,38481,3847,38446,3842,3839,3837,38358,38331,3831,38313,3830,38270,3825,3823,38224,38205,38194,3817,3813,3812,3811,3810,3806,3803,38029,3799,3798,3796,3795,3793,3790,3788,3787,37855,37789,37777,37674,3765,37647,37614,37607,37522,3749,3742,37393,3728,37218,37185,37174,37151,3712,37121,36983,36962,36950,36914,3683,36824,36823,3681,3680,36748,3672,36710,3670,3669,36694,36677,36659,3663,3658,3656,36552,3653,36530,3652,36508,36436,3637,3636,36368,36275,36256,3622,3621,36105,36104,36046,3603,3602,3600,3599,35986,35929,35906,35901,35900,35879,3586,3577,35731,35593,35553,35506,35401,35393,35392,35349,3532,3530,35272,3526,35217,3520,3519,3515,3513,35131,3511,35116,3506,3505,35050,3503,35033,3497,34875,3486,3485,3483,34833,3479,34783,34765,34728,34683,34510,34507,3443,34401,3439,34381,34341,34317,3430,3425,3419,34189,3415,3414,34096,34036,34021,3396,33895,3388,33889,33882,33879,33841,3374,3368,3365,3363,3362,33605,33604,33550,33523,33522,33444,33395,33367,3334,33337,33335,33327,33277,33203,33200,3319,33192,33175,33124,3311,3310,33087,33070,33017,33011,33000,32976,32961,32960,32944,32932,3291,32911,32910,32908,32905,32904,32898,32897,32888,32871,32869,32868,32858,32842,32837,32820,3281,32815,32814,3280,32807,32799,32798,32797,32790,32789,32788,32767,32765,32764,3263,3240,32261,32260,32219,3220,32200,3210,32102,32088,32031,32022,3200,32006,3190,31728,3167,31657,31522,3146,31438,31386,31339,3121,3118,31072,31058,3103,31033,3102,3089,30896,3080,30705,30659,30644,3062,30599,3057,30519,30299,3023,30195,3014,30087,3002,30001,2997,2991,2988,2987,2984,29810,2973,2958,2957,29507,2930,29243,29152,2908,29045,2902,2901,2898,28967,28924,2889,2888,28851,28850,2882,28717,28567,2850,2847,28374,28142,2812,28114,2806,2804,28017,27770,27537,27521,27372,27351,27350,2734,27316,2728,2723,27204,2712,2711,27087,27075,27074,2706,27055,27019,27018,27017,27016,27015,2700,26972,2691,26669,2644,26417,26340,2631,2623,2622,2606,26007,26001,2598,2584,25847,2583,2580,25717,25703,2567,2558,25565,2551,2550,25486,25473,25445,2532,25327,2531,25288,25262,25260,25174,2505,25001,25000,24999,2472,2463,24616,2456,24554,24552,2449,24416,2439,24392,2438,2436,2435,2425,24218,2418,23953,2391,23887,2376,2375,2372,23723,2371,23451,23430,2340,23382,2335,23342,2330,23296,23270,2326,2325,23228,23219,2313,2312,2304,23040,2302,23017,2300,22969,22959,2292,2291,22882,2280,22769,22727,2271,22719,22711,2270,2269,2265,2262,2261,22563,22555,2253,2250,22350,22341,22290,2224,22223,22200,22177,22128,22125,22100,22063,2203,22022,2197,21915,21891,2187,21728,21634,21631,2150,2148,21473,2142,2134,2124,21201,2115,21078,2104,2101,21011,20990,2096,2095,20940,20934,20883,2087,2086,2083,2082,2081,2080,20734,2070,2069,2062,20473,2031,20280,20228,20227,20226,20225,20224,20223,20180,20179,20147,20127,20125,20118,20111,20106,20102,20089,20085,20080,20076,20052,20039,20032,20021,20017,20011,20001,19996,19995,19852,1981,1976,1975,1973,19715,19634,19612,1958,1954,19501,19464,19403,19353,19333,1927,1924,19201,19200,1918,19130,1912,1911,1901,19010,18962,18910,18887,18874,1883,1871,18669,1861,1858,18569,18517,18505,18439,18380,1835,18337,18336,18333,1825,1823,18231,18148,1811,1808,18080,1807,1806,18015,18012,1800,1799,17997,17985,17969,1792,1791,17867,17860,17802,17801,17715,17702,17701,17700,1753,1752,1750,17500,1745,17413,17409,1736,1735,1730,17255,17251,1722,1715,1713,1712,17129,1711,1709,1708,17089,1707,17070,1703,1701,17017,17016,1699,1694,1691,16901,16900,16845,1683,16797,1677,16725,16724,16723,16464,1645,1638,16372,1635,16349,1632,16297,16286,16283,16273,16270,1622,1620,16161,1615,1607,1605,16048,1598,1592,15915,1584,15758,15730,15722,1569,15677,15670,1566,1565,15646,15645,15631,1560,1559,1558,15550,15448,15344,15317,15275,15191,15190,15145,15050,15005,14916,14891,14827,14733,14693,14545,14534,14444,14443,14418,14254,14237,14218,14147,14001,13899,13846,13784,13766,13730,13723,13695,13580,13502,1340,1339,1336,13359,13340,1331,13318,1330,13306,1327,13265,13264,13261,13250,1324,13229,1321,1319,13194,13193,13192,1318,13188,1317,1316,13167,1315,1314,13149,13142,13140,13132,13130,13093,1308,1307,1306,1305,1303,1302,13017,1299,1297,12962,12955,1291,1290,12892,12891,12865,1282,1279,1276,12766,12702,12699,1268,1264,1262,1261,1251,1250,1249,1243,12414,1240,1239,12340,1229,12296,1228,12275,12271,12251,12243,12240,1223,12225,1221,12192,12171,1215,12156,12146,12137,12132,12121,1211,1210,1209,12097,12096,12090,1208,12080,1207,12077,1204,12034,12031,12019,1200,12009,12005,12002,12001,1196,1195,1194,11940,1191,1190,1188,11863,11862,1184,1182,11813,1180,1179,1176,1173,11735,11697,1168,1167,1162,1159,1157,1156,11552,1153,1150,1144,1143,11401,1136,1135,1134,11296,1128,11288,1125,11250,11224,11200,1118,11180,1116,11100,11089,11033,11032,11031,11026,1101,11019,11007,11003,11001,11000,10900,10878,10852,10842,10754,10699,10602,10601,10567,10565,10556,10555,10554,10553,10552,10551,10550,10535,10529,10509,10500,10494,10443,10414,10387,10357,10347,10338,10280,10255,10246,10245,10238,10115,10101,10093,10064,10045,10042,10035,10020,10019,10018,10007,10006,983,979,973,967,965,961,942,935,926,925,914,863,858,844,834,830,817,815,811,809,789,779,769,762,743,706,7005,678,66,642,635,6105,5977,591,578,5632,54320,5308,509,47,446,400,4008,3985,32787,32786,31416,27001,22273,1989,1507,1495,1492,1444,1441,11,1019,9991,989,985,984,974,958,952,949,946,923,91,916,899,897,894,889,861,860,847,835,833,828,824,814,807,804,798,771,76,75,750,733,727,716,707,695,68,682,665,664,653,649,634,629,620,615,6110,603,577,538,52,525,510,501,449,440,4199,3398,3064,3049,3045,27010,237,219,1680,1663,1652,158,1420,1366,1364,1359,1358,12,122,1139,10,104,101,988,962,950,948,945,941,938,936,92,929,927,919,9104,906,883,881,875,872,870,866,855,851,850,841,836,831,826,820,819,816,813,8076,791,761,760,7597,745,741,736,735,7273,724,719,702,696,673,6665,663,661,658,651,647,640,6401,638,6347,632,630,627,609,605,5978,5400,5300,5232,5191,5145,50,507,492,491,4660,45,4557,450,448,3900,353,343,334,3086,300,28,27374,268,249,2430,230,2307,221,2120,2024,2018,2014,1991,1988,16,1651,1552,1551,1523,1517,1484,1474,1465,1445,1404,1402,1400,1399,1389,1388,1385,1384,1370,1356,1349,1346,1214,1178,112,1018,1016,997,994,991,97,975,970,968,964,963,960,959,951,947,944,939,933,9107,9106,9105,909,895,891,886,879,869,868,867,854,837,832,821,812,8123,799,797,796,794,788,770,756,751,734,723,721,718,708,704,703,7009,69,694,692,689,685,681,680,676,675,670,6701,6588,656,654,644,637,633,628,624,622,6143,611,60,561,560,553,5530,51,511,505,47557,454,4500,4480,40,402,35,3397,3292,3264,3141,27665,262,253,231,214,213,2064,2026,201,2015,1997,1996,1995,194,182,18184,18182,180,1762,1668,1664,1650,15,1539,1535,1527,1515,14,1497,1496,1486,1476,1475,1467,1466,1435,14141,1412,1405,1403,1401,1387,1381,137,1379,1373,1372,13720,1369,1354,1348,11371,103,1017,1003,982,978,972,966,95,957,956,94,93,934,920,915,908,907,9051,892,890,887,885,884,882,877,8770,876,871,865,857,853,852,849,848,842,838,827,818,793,785,784,776,774,764,763,7634,759,755,74,747,746,73,738,737,71,717,712,7008,7006,699,698,697,688,686,677,672,6700,6544,65301,645,6400,626,619,6147,6146,6145,6142,6111,608,607,604,601,5997,58,568,536,5302,5301,493,486,466,462,453,44,437,422,418,415,4144,4132,412,410,404,403,401,399,397,38,362,355,3531,350,34,3457,336,325,31,315,308,303,29,276,273,2627,26208,261,260,2432,2431,236,235,233,224,206,2053,204,202,2027,2023,200,1994,1992,1990,1986,196,193,1827,181,18183,18181,177,176,1763,1667,1662,1661,16444,1549,1548,1545,1544,1538,1537,1531,1529,1528,1519,1513,1511,1510,1499,1498,1493,1483,1479,1472,1456,1454,1446,1442,1439,1438,1437,1436,1432,1426,1424,1422,1410,1409,1398,1397,1394,1393,1390,138,1386,1376,13713,136,1368,1365,1362,1355,133,129,120,118,115,114,986,977,976,96,955,954,937,932,910,8,896,893,845,781,775,773,768,767,766,753,752,7464,744,742,739,7326,72,67,662,65,6548,652,643,618,614,6141,613,612,599,598,596,583,582,572,571,5717,5714,5713,570,56,569,564,552,54,5490,542,535,533,530,5303,528,526,522,5193,518,516,4987,496,48,487,485,480,479,473,472,470,4672,460,457,452,451,439,438,435,434,432,43188,428,423,420,414,413,4133,408,3984,392,391,383,380,373,370,369,364,361,360,358,352,351,346,3421,337,329,326,322,316,305,2,295,294,293,289,288,284,277,2766,271,270,27009,27007,27005,27003,27002,267,265,258,2564,248,238,234,229,228,226,217,216,2108,209,205,2028,2019,2016,1993,1987,192,191,19150,190,189,185,184,18187,174,173,17300,17007,168,1672,1671,1670,162,1543,1542,1541,1540,1532,151,1518,15151,150,1509,1508,1505,1502,149,1491,148,1488,1482,1480,1473,1470,1469,1464,1462,1459,1458,1457,1453,1451,1449,1448,1440,1430,142,1429,1427,1423,141,1419,1418,1416,1411,1408,1407,1396,1395,1391,1383,1374,13721,1371,13718,13715,13714,13701,1367,1363,1361,1360,132,130,128,124,117,116,108,9997,9996,9994,9993,9987,9981,9978,9966,9956,9955,9954,9953,9952,9951,9925,9903,9899,9889,9888,9802,9801,9800,9762,9753,9750,9747,9695,9668,9640,9632,9631,9630,9629,9617,9614,9612,9599,9598,9597,9596,9555,9536,9522,9450,9445,9402,9401,9397,9396,9390,9389,9388,9387,9380,9374,9346,9345,9344,9339,9321,9318,9312,9310,9306,9295,9294,9293,9292,9286,9285,9284,9283,9282,9281,9280,9279,9278,9277,9255,9222,9217,9216,9215,9214,9213,9212,9209,9208,9206,9205,9204,9203,9201,9164,9163,9162,9123,9122,9119,9093,9092,9089,9088,9087,9086,9085,9083,9060,9026,9025,9024,9023,9008,9007,8998,8997,8991,8990,8989,8981,8953,8937,8913,8912,8911,8910,8901,8881,8834,8809,8808,8807,8805,8804,8793,8787,8786,8778,8769,8768,8767,8764,8763,8750,8733,8732,8711,8710,8699,8688,8666,8665,8615,8614,8613,8612,8611,8610,8609,8567,8555,8554,8503,8502,8501,8473,8457,8450,8444,8442,8423,8417,8416,8415,8405,8404,8384,8380,8379,8378,8377,8376,8351,8322,8321,8320,8313,8301,8280,8276,8270,8266,8243,8230,8211,8208,8207,8206,8205,8204,8199,8195,8191,8190,8184,8183,8182,8162,8161,8160,8153,8149,8148,8140,8132,8131,8130,8129,8128,8122,8121,8117,8115,8111,8102,8101,8091,8077,8074,8070,8067,8066,8059,8058,8057,8056,8055,8054,8053,8051,8044,8043,8041,8040,8034,8033,8032,8026,8020,8004,7997,7982,7981,7980,7979,7967,7962,7933,7932,7903,7902,7901,78,7887,7880,7872,7871,7870,7869,7847,7846,7845,7810,7802,7801,7799,7798,7797,7794,7787,7786,7784,7781,7779,7775,7747,7743,7742,7738,7734,772,7728,7727,7726,7724,7720,7708,7707,7701,7700,7697,7689,7687,7683,7680,7677,7675,7674,7673,7672,7663,7648,7633,7631,7630,7629,7626,7624,7606,7588,7574,7570,7569,7566,7563,7560,7551,7550,7549,7548,7547,7546,7545,7544,7543,7542,7511,7510,7509,7508,7491,7478,7474,7473,7471,7437,7431,7430,7429,7428,7427,7426,7421,7420,7411,7410,7401,7397,7395,7394,7393,7392,7391,7365,7359,7358,7357,7356,7355,7354,7353,7352,7351,7350,7349,7348,7347,7346,7344,7343,7342,7341,7340,7339,7338,7337,7336,7335,7334,7333,7332,7331,7330,7329,7328,7327,7324,7323,7322,7321,7319,7318,7317,7316,7315,7314,7313,7312,7311,7310,7309,7308,7307,7306,7305,7304,7303,7302,7301,7283,7282,7280,7279,7277,7276,7275,7274,7262,7244,7237,7236,7235,7234,7229,7228,7227,7216,7215,7202,7181,7174,7173,7172,7171,7170,7169,7168,7167,7166,7165,7164,7163,7162,7161,7129,7128,7117,7107,7095,7088,7073,7040,7031,7030,7026,7023,7022,7021,7020,7018,7017,7016,7015,7014,7013,7012,7011,6999,6998,6997,6970,6966,6965,6964,6963,6962,6961,6951,6946,693,6936,6935,6924,6900,6868,6850,6842,6841,6831,6817,6801,679,6791,6790,6787,6786,6785,6784,6778,6777,6771,6770,6769,6768,6767,671,6716,6715,6714,6703,6702,6697,6696,6690,6688,6687,6679,6678,6673,6672,6671,6657,6656,6655,6653,6640,6634,6633,6632,6629,6627,6626,6625,6624,6623,6622,6621,6620,6602,6601,6583,6582,6581,6568,6558,6556,6551,6549,6515,6514,6513,650,6509,6508,6507,6506,6505,6501,64,6489,6488,6487,6486,6485,6484,6483,6482,6480,6471,6464,6456,6455,6446,6445,6444,6443,6442,6440,6432,6421,6420,6419,6418,6417,6410,6409,6408,6407,6406,6405,6404,6403,6402,63,6390,6382,6370,6363,6360,6355,6344,6343,6326,6325,6322,6321,6320,6317,6316,6315,6306,6301,6300,62,6269,6268,6267,6253,6252,6244,6243,6242,6241,6209,6201,6200,61,6163,6162,6160,6159,6149,6148,6144,61441,61440,61439,6140,6133,6130,6124,6122,6121,6118,6117,6116,6114,6109,6108,6107,6104,6102,6099,6088,6087,6086,6084,6083,6082,6081,6080,6076,6075,6074,6073,6072,6071,6070,6069,6066,6064,6061,6058,6057,6056,6054,6053,6049,6048,6047,6046,6045,6044,6043,6042,6041,6040,6039,6038,6037,6036,6035,6034,6033,6032,6031,6029,6028,6027,6026,6024,6023,6022,6020,6019,6018,6016,6014,6013,6012,6011,5,5993,5992,5991,5990,5984,597,5979,595,594,592,5913,590,589,588,5883,586,5863,585,584,5842,5841,581,5813,580,579,5794,5793,5787,5786,5785,5784,5783,5782,5781,5780,5777,5771,5770,576,5769,5768,5767,5766,575,5757,5755,5750,574,5748,5747,5746,5745,5744,5743,5742,5741,573,5729,5728,5727,5726,5725,5724,5720,5719,5716,5715,5705,5700,5696,5693,5689,5688,5687,5684,5683,5682,5681,567,5677,5676,5675,5674,5673,5671,5670,566,565,5646,5639,5638,5637,5636,5635,5634,5630,562,5629,5628,5627,5618,5605,5604,5603,5602,5601,5600,559,5599,5598,5597,558,5586,5585,5584,5583,5582,5579,5575,5574,5573,5569,5568,5567,5565,5556,5540,551,550,5507,5506,5505,5504,5503,549,547,5474,5472,5471,5470,546,5465,5464,5463,5462,5461,5456,5455,5454,5453,5450,5445,5443,5437,5436,5435,5434,5430,5429,5428,5427,5426,5425,5424,5422,5421,5420,5419,5418,5417,5416,5415,5413,5412,5411,5410,5409,5408,5407,5406,5404,5403,5402,5401,539,5399,5398,5397,537,5364,5363,5362,5361,5360,5359,5358,5356,5355,5354,5352,5351,5350,534,5349,5344,5343,532,5321,5320,531,5318,5317,5316,5315,5314,5313,5312,5310,5309,5307,5306,5305,5304,529,5299,5282,5281,527,5272,5271,5270,5265,5264,5254,5253,5251,5249,5248,5247,5246,5245,5237,5236,5231,5230,5229,5228,5227,5224,521,5215,520,5209,5203,519,5197,5196,5195,5194,5192,517,5172,5168,5167,5166,5165,5164,5163,5162,5161,5157,5156,5155,5154,5153,5150,5146,5136,5135,5134,5117,5116,5115,5112,5107,5106,5105,5104,5103,5099,5094,5093,5092,508,5086,5085,5084,5083,5082,5079,5078,5075,5073,5072,5071,506,5069,5068,5067,5065,5064,5062,5059,5058,5057,5056,504,5049,5048,5047,5045,5044,5043,5042,503,5034,5032,5031,5029,5028,5027,5026,5025,5024,5022,5008,5007,5006,499,4991,4990,498,4989,4988,4986,4985,4984,4980,4971,4970,4969,495,4953,4952,4951,4950,494,4942,4941,4940,4937,4936,4915,49150,4914,4913,490,4902,4901,49001,49000,489,4894,488,4889,4888,4885,4884,4883,4882,4880,4879,4878,4871,4870,4869,4868,4867,48653,48556,4851,4850,484,4849,4847,4846,4845,4844,4843,4842,4841,483,4839,4838,4837,482,4827,48129,48128,48050,4804,48049,48048,4803,4802,4801,48005,48004,48003,48002,48001,48000,4791,4790,478,4789,4788,4787,4786,4785,4784,47809,47808,477,4774,476,4756,4753,4752,4751,4750,474,4749,4747,4746,4744,4743,4742,4741,4740,4739,4738,4737,4733,4732,4731,4730,4729,4728,4727,4726,4725,471,4711,47100,4704,4703,4702,4701,47001,47000,46,469,46999,46998,4692,4691,4690,468,4688,4686,4685,4684,4683,4682,4681,4680,467,4679,4678,4677,4676,4675,4674,4673,4671,4670,4669,4668,4667,4666,4664,4663,4661,4659,4646,463,46336,4621,461,4605,4604,4603,459,4598,4597,4596,45966,4595,4594,4593,4592,4591,4590,45825,45824,4573,4569,4568,45678,4566,4563,455,4556,4554,4553,4552,4551,45514,4549,4548,4547,4546,4538,4537,4536,4535,45054,45045,4502,45002,45001,45000,44900,4488,4487,4486,4485,4484,44818,4460,44600,4458,4457,4456,4455,44553,44544,4453,4452,4451,4450,4448,44445,44444,4441,4432,44323,44322,44321,4431,4429,4428,4427,4426,4425,4423,4422,4421,4420,4419,4417,4416,4413,4412,44123,4411,4410,4409,4408,4406,4405,4404,4403,4402,4400,4396,4395,4394,4393,4392,4391,4390,4389,4379,4378,4377,4373,4372,4371,4370,436,4368,4366,4362,4361,4360,4359,4354,4353,4352,4351,4350,4349,4348,4347,4346,4345,4344,43441,43440,43439,43438,4341,4340,433,4336,4335,4334,4332,4331,4330,4329,4327,4326,4324,4323,4322,43210,4320,431,43191,43190,43189,4316,4314,4313,4312,4311,4310,430,4309,4308,4307,4306,4305,4304,4303,4301,429,4299,4296,4295,4293,4292,4291,4290,4289,4288,4287,4286,4285,4284,4283,4282,4281,4280,4278,4277,4276,4275,4274,4273,4272,4271,4270,426,4269,4268,4267,4266,4265,4264,4263,4261,4260,4259,4258,4257,4256,4255,4254,4253,4251,4250,42509,42508,424,4249,4248,4247,4246,4245,4244,4241,4240,4239,4238,4237,4236,4235,4233,4232,4231,4230,4229,4228,4227,4226,4225,4223,4222,4221,421,4219,4218,4217,4216,4215,4214,4213,4212,4211,4210,4209,4208,4207,4205,4204,4203,4202,4201,41,4197,4195,4193,4191,4189,4188,4187,4186,4185,4184,4183,4182,4181,4180,4179,41797,41796,4178,4177,4176,4175,4173,4172,4171,4170,4169,4168,4167,4166,4165,4163,4162,4160,4159,4157,4156,4155,4154,4153,4152,4151,4150,4149,4148,4146,4145,4142,4140,4139,4138,4137,4136,4134,4131,4130,4128,4127,4124,4123,41230,4122,4117,4116,4115,4114,41121,41111,4110,4109,4108,4107,4106,4105,4104,4103,4102,409,4099,4098,4097,4095,4094,4093,4092,4091,4089,4088,4086,4085,40853,4084,40843,40842,40841,4083,4082,4081,4079,4078,4077,4076,4075,4074,4073,4072,4071,4070,4069,4068,4067,4066,4064,4063,4062,4061,4060,405,4059,4057,4055,4054,4053,4052,4051,4050,4049,4047,4046,4044,4043,4042,4041,40404,4038,4037,4034,4033,4032,4031,4030,4028,4027,4026,4023,4021,4019,4018,4017,4015,4014,4013,4012,4011,40023,39,398,3988,3987,3978,3977,3976,3974,3973,3970,396,39681,3966,3965,3960,395,3959,3958,3955,3954,3953,3951,3950,394,3947,3942,393,3939,3938,3934,3933,3932,3927,3926,3925,3924,3921,3917,3912,3910,390,3903,3898,3896,3895,3894,3893,3892,3891,3887,3886,38865,3885,3884,3883,3881,38800,387,3877,3875,3874,3873,386,3867,3866,3865,3864,3864,3862,3861,385,3858,3857,3855,3854,384,38472,38462,3845,3844,3843,38422,3841,38412,3840,3838,3836,3835,3834,3833,3832,382,3829,3822,3821,38203,38202,38201,381,3819,3818,3816,3815,3807,3805,3804,3802,38002,38001,38000,379,3797,3794,3791,378,3789,3786,3785,3783,3782,3781,3780,377,3779,3778,3777,3776,3775,3774,3773,3772,3771,3770,376,3769,3768,3767,37654,3764,3763,3762,3761,3760,37601,375,3759,3758,3757,3756,3755,3754,3753,3752,3751,3750,374,3748,37483,3747,37475,37472,3746,3745,3744,3743,3741,3740,3739,3738,3736,3735,3734,3733,3732,3730,372,3729,3727,3726,3725,3724,3723,3722,3721,3720,371,3719,3718,3716,3715,3714,3713,3711,3710,3709,3708,3707,3706,3705,3704,3702,3701,3699,3698,3696,3695,3693,3692,3691,368,3688,3687,3686,36865,3685,3682,367,3679,3678,3677,3676,3675,3674,3673,3671,36700,3668,3667,3666,3665,3664,3662,3661,3660,36602,365,3657,3655,3654,36524,3651,3650,3649,3648,3647,3646,36462,3645,3644,36444,36443,3643,3642,36424,36423,3641,36411,3640,363,3639,3638,3635,3634,3633,3631,3630,3629,3628,3627,3626,3625,3624,3623,3620,3619,3618,3617,3616,3615,3614,3613,3612,3611,3610,3609,3608,3607,3606,3605,3604,3601,36001,359,3598,3597,3596,3595,3594,3593,3592,3591,3590,3589,3588,3587,3585,3584,3583,3582,3581,357,3579,3578,3576,3575,3574,3573,3572,3571,3570,356,3569,3568,3567,3566,3565,3564,3563,3562,3561,3560,3559,3558,3557,3556,3555,3554,3553,3552,3550,354,3549,3548,3547,3545,3544,3543,3542,3541,3540,3539,3538,3537,3536,3535,35357,35356,35355,35354,3534,3533,3529,3528,3525,3524,3523,3522,3521,3518,3516,3512,3510,35100,3509,3508,3507,3504,3502,3501,3500,35006,35005,35004,35003,35002,35001,35000,349,3499,3498,34980,3496,34964,34963,34962,3495,3494,3492,3491,3490,348,3489,3488,3484,3482,3481,3480,347,3478,3477,3475,3474,3473,3472,3471,3470,3469,3468,3467,3466,3465,3464,3463,3462,3461,3460,345,3459,3458,34567,3455,3454,3453,3452,3451,3450,344,3449,3448,3447,3446,3445,3444,3442,3441,3440,3438,3437,34379,34378,3436,3435,3434,3433,3432,3431,3429,3428,3427,3426,3424,34249,3423,3422,3420,3418,3417,3416,3413,3412,3411,3409,3408,3407,3406,3405,3402,3401,3395,3394,3393,3392,3391,33890,3387,3386,3385,3384,3383,3382,3381,3380,3379,3378,3377,3375,3373,3366,33656,3364,3361,3360,3359,3358,3357,3356,3355,3354,3353,3352,3350,3349,3348,3347,3346,3345,3344,3343,33435,33434,3342,3341,3340,3339,3338,3337,3336,3335,33334,33333,33331,3332,3331,3330,3329,3328,3327,3326,3321,3320,3318,3317,3316,3315,3314,3313,3312,33123,3309,3308,33060,3305,3303,3302,3298,3297,3296,3295,3294,3293,3290,3289,32896,3288,3287,3286,3285,3284,3282,32811,32801,3279,3278,3277,3276,3275,3274,3273,3272,3271,3270,3267,3266,3265,32636,32635,3262,3259,3258,3257,3256,3255,3254,3253,3252,3251,3250,324,3249,3248,32483,3247,3246,3245,3244,3243,3242,3241,32400,323,3239,3238,3237,3236,3235,3234,3233,3232,3231,3230,3229,3228,3227,3226,3225,3224,32249,3223,3222,321,3219,3218,3217,3216,3215,3214,3213,3212,320,3209,3208,3207,3206,3205,3204,3203,32034,3202,3201,319,3199,3198,3197,3196,3195,3194,31949,31948,3193,3192,3191,318,3189,3188,3187,3186,3185,3184,3183,3182,3181,3180,317,3179,3178,3177,3176,31765,3175,3174,3173,3172,3171,3170,3169,31685,3166,3165,3164,3163,31620,3161,3160,3159,3158,3157,3156,3155,3154,3153,3152,3151,3150,314,3149,3148,3147,3145,31457,3144,3143,3142,3140,31400,313,3139,3138,3137,3136,3135,3134,3133,3132,3131,3130,312,3129,3127,3125,3124,3123,3122,3120,3117,3116,3115,3114,3113,3112,3111,3110,310,3109,3108,3107,3106,3105,3104,31029,31020,3101,31016,3100,309,3099,30999,3098,3096,3095,3094,3093,3091,3090,3088,3087,3085,3084,3083,30832,3082,3081,3079,3078,3076,3075,3074,3073,3072,3070,3069,3068,3067,3066,3065,3061,3060,3059,3058,3056,3055,3054,3053,3051,3048,3047,3046,3044,3043,3042,3041,3040,30400,3039,3038,3037,3036,3035,3034,3033,3032,3029,3028,3027,3026,30260,3024,3022,3021,3020,3019,3018,3016,3015,3012,3010,30100,3009,3008,3004,30004,30003,30002,2999,29999,2996,2995,2994,2993,2992,2990,2989,2986,2985,2983,2982,2981,2980,2979,2978,2977,2976,2975,2974,2972,2971,2970,2969,2966,2965,2964,2963,2962,2961,2960,2959,2956,2955,2954,2953,2952,2951,2950,2949,2948,2947,2946,2945,2944,2943,2942,2941,2940,2939,2938,2937,2936,2935,2934,2933,2932,2931,2929,2928,2927,2926,2924,2923,2922,2921,2919,2918,2917,2916,29167,2915,2914,2913,2912,2911,2907,2906,2905,2904,2900,29000,2899,2897,2896,2895,2894,2893,2892,2891,2890,2887,2886,2885,2884,2883,2881,2880,287,2879,2878,2877,2876,2874,2872,2871,2870,286,2868,2867,2866,2865,2864,2863,2862,2861,2860,2859,2858,28589,2857,2856,2855,2854,2853,2852,2851,2849,2848,2846,2845,2844,2843,2842,2841,2840,283,2839,2838,2837,2836,2835,2834,2833,2832,2831,2830,282,2829,2828,2827,2826,2824,28240,2823,2822,2821,2820,28200,281,2819,2818,2817,2816,2815,2814,2813,28119,2810,2808,2807,2805,2803,2801,28010,28001,28000,2799,27999,2798,2797,2796,2795,2793,2792,2791,2790,2789,2788,2787,27876,2786,2785,2784,2783,2782,2781,2780,2779,2778,27782,2777,2776,2775,2774,2773,2772,2771,2770,2769,2768,2767,2765,2764,2763,2762,2761,2760,2759,2758,2757,2756,2755,2754,2753,2752,2751,2750,27504,2749,2748,2747,2745,2744,27442,2743,2742,2741,2740,2739,2738,2737,2736,2735,27345,2733,2732,2731,2730,2729,2727,2726,2724,2722,2721,2720,2719,2716,2715,2714,2713,2709,2708,2707,2705,2704,2703,27008,27006,27004,269,2699,2698,2697,2696,2695,2694,2692,2690,2689,2688,2687,2686,2685,2684,2683,2681,2680,2679,2678,2677,2676,2675,2674,2673,2672,2671,2670,266,2669,2668,2667,2666,2665,2664,2663,2662,2661,2660,2659,2658,2657,2656,2655,2654,2653,2652,2651,2650,2649,2648,26489,26487,2647,2646,2645,2643,2642,2641,2640,263,2639,2637,2636,2635,2634,2633,2632,2630,2629,2626,26263,26262,26261,26260,2625,26257,2624,2621,2620,2619,2618,2617,2616,2615,2614,2613,26133,2612,2611,2610,2609,2603,2599,2597,2596,2595,25955,25954,2594,2593,2592,2591,2590,25903,25902,25901,25900,2589,2588,2587,2586,2585,2582,2581,2579,25793,2578,2577,2576,2575,2574,2573,2572,2571,2570,2569,2568,2566,2565,2563,2562,2561,2560,25604,2559,25576,2556,2555,2554,2553,2552,2549,2548,2547,25471,2546,2545,2544,2543,2542,2541,2540,2539,2538,2537,2536,2535,2534,2533,2530,2529,2528,2527,2526,2524,2523,2521,2520,2519,2518,2517,2516,2515,2514,2513,2512,2511,2510,2509,2508,2507,2506,2504,2503,2502,25009,25008,25007,25006,25005,25004,25003,25002,2499,2498,2497,2496,2495,2494,2493,24922,2491,2490,2489,2488,2487,2486,2485,24850,2484,2483,2482,2481,2480,247,2479,2478,2477,2476,2475,24754,2474,2473,2471,2470,246,2469,2468,24680,2467,24678,24677,24676,2466,24666,2465,2464,2462,2461,2460,245,2459,2458,2457,24577,2455,2454,2453,2452,2451,2450,244,2448,2447,2446,24465,2445,2444,2443,2442,2441,2440,243,24386,2437,2434,24323,24322,24321,242,2429,2428,2427,2426,2424,24249,24242,2423,2422,2421,2420,2419,2417,2416,2415,2414,2413,2412,2411,2410,2409,2408,2407,2406,2405,2404,2403,2402,2400,24006,24005,24004,24003,24002,24001,24000,2398,2397,2396,2395,2392,2390,2389,2388,2387,2386,2385,2384,2380,2379,2377,2374,2373,2370,2368,2367,2365,2364,2363,2362,2361,2360,2359,2358,2357,2356,2355,2354,23546,2353,2352,2351,2350,2349,2348,2347,2346,2345,23457,23456,2344,2343,2342,2341,23402,23401,23400,2339,2338,2337,2336,2334,2333,23333,2332,2331,2329,23294,2328,2327,23272,2324,2322,2321,2320,2319,2318,2317,2316,2315,2314,2311,2310,2309,2308,2306,2305,23053,2303,23005,23004,23003,23002,23001,23000,2299,2298,2297,2296,2295,22951,2294,2293,2290,2289,2287,2286,2285,2284,2283,2282,2281,22800,2279,2278,2277,2276,22763,2275,2274,2273,2272,2268,2267,2266,2264,2263,2259,2258,2257,2256,2255,2254,22537,2252,2249,2248,2247,2246,2245,2244,2243,2242,2240,2239,2238,2237,22370,2236,2235,22351,2234,22347,22343,2233,22335,22321,2231,2230,22305,2229,2228,22289,2227,2226,2225,2223,2221,2220,2219,2218,2217,2216,2215,2214,2213,2212,2211,2210,2209,2208,2207,2206,2205,2204,2202,22005,22004,22003,22002,22001,22000,2199,2198,2193,2192,218,2189,2188,2186,2185,2184,21849,21848,21847,21846,21845,2183,2182,2181,2180,21800,2178,2177,2176,2175,2174,2173,2172,2171,2169,2168,2167,2166,2165,2164,2163,2162,215,2159,21590,2158,2157,2156,2155,21554,21553,2154,2153,2152,2151,2149,2147,2146,2145,2143,2141,2140,2139,2138,2137,2136,2133,2132,2131,2130,2129,2128,2127,2125,2123,2122,21221,21213,21212,2118,2117,2116,2114,2113,2110,2109,2102,21010,21000,20999,2098,2097,2094,2093,2092,2091,2090,208,2089,2088,2085,2084,207,2079,2078,2077,2076,2075,2074,2073,2072,2071,20670,2066,2063,2061,2060,2059,2058,2057,2056,2055,2054,2052,2051,2050,20480,203,2039,2037,2036,2032,2029,20202,2017,20167,20057,20049,20048,20046,20034,20014,20013,20012,20003,19999,19998,198,1985,1983,1982,1980,197,1979,1978,19788,1977,1970,1969,1968,1967,1966,1965,1964,1963,1962,1961,1960,195,1959,1957,1956,1955,19541,19540,1953,19539,1952,1951,1950,1949,1948,1946,1945,1944,1943,1942,1941,19412,19411,19410,1940,1939,19398,1938,1937,1936,1934,1933,1932,1931,1930,1929,1928,1926,1925,1923,1922,19220,1921,1920,1919,19194,19191,1917,1916,1915,1913,1910,1909,1908,1907,1906,1905,1904,1903,1902,19020,19007,19000,18,1899,1898,1897,1896,1894,1893,1892,1891,1890,188,1889,1888,18888,18881,1887,1886,1885,1884,1882,1881,1880,187,1879,1878,1877,1876,18769,1874,1873,1872,1870,186,1869,1868,1867,1866,18668,1865,18635,18634,1860,1859,1857,1856,1855,1854,1853,1852,1851,18516,1850,1849,1848,1847,1846,18463,1845,1844,1843,1842,1841,183,1838,1837,1836,1834,1832,1831,1830,1829,1828,1826,18262,1824,18243,18242,18241,1822,1821,1820,1819,1818,18186,18185,1817,1816,1815,1814,1813,18136,1810,18104,1809,1804,1803,1802,1798,1797,1796,1795,1794,1793,1790,178,1789,1788,1787,1786,1785,1784,1781,1780,1779,1778,1777,17777,1776,1775,17756,17755,17754,1774,1773,1772,17729,1771,1770,1769,1768,1767,1766,1765,1764,1760,175,1759,1758,1757,1756,17555,1754,1751,1749,1748,1747,1746,1744,1743,1742,1741,1740,1739,1738,1737,1734,1733,1732,1731,172,1729,1728,1727,1726,1725,1724,17235,17234,17225,17224,17223,17222,17221,17220,17219,171,17185,17184,1716,1714,1710,170,1706,1705,1704,1702,169,16995,16994,16991,1698,1697,1696,1695,16959,16950,1693,1692,1690,1689,1686,1685,1684,1682,1681,167,1679,1678,16789,1676,1675,1674,1673,166,1669,16666,16665,1665,16619,1660,165,1659,1657,1656,1655,1654,1653,164,1649,1648,1647,1646,1644,1643,1642,1640,1639,16385,16384,1637,1636,16368,16367,16361,16360,1634,1633,1631,16311,16310,1630,16309,1629,1628,1627,1626,1625,1623,1621,1619,1618,1617,1616,16162,1614,1613,1612,1611,1610,160,1609,1608,1606,1604,1603,1602,16021,16020,1601,16003,16002,159,1599,15999,15998,1597,1596,1595,1593,1591,1590,1589,1588,1587,1586,1585,1582,1581,1579,1578,1577,1576,1575,1574,15740,1573,1572,1571,1570,156,1568,1567,1564,1563,1562,1561,155,1557,1555,15555,1554,1553,154,1546,153,1536,15363,1534,15345,1530,152,1520,1514,1512,15126,15118,1506,1504,14937,14936,1490,1489,1487,1485,1481,147,1478,1477,1471,1468,1463,1460,145,1452,1450,14500,1447,14414,1431,1428,1425,14250,1421,1415,14154,14150,14149,14145,14143,14142,140,1406,14034,14033,14002,13930,1392,13929,13894,13882,1382,13823,13822,13821,13820,13819,13818,1380,1378,13786,13785,1377,1375,13717,13716,13712,13711,13710,13709,13708,13706,13705,13702,134,1345,1344,1343,1342,1341,13400,1338,1335,1333,1332,1329,1326,1325,1323,13224,13223,13217,13216,1320,131,13160,1313,1312,1304,1298,1295,1294,1293,1292,1289,1288,1286,1285,1284,1283,1281,1280,1278,1275,12753,1274,1273,126,1269,1267,1266,1265,1263,1260,1258,1257,1256,1255,1254,1253,1252,1246,1245,1242,1238,1237,1235,1232,12322,12321,1231,1230,12302,12300,1227,1226,1225,1224,121,1219,12172,12168,12109,1206,1205,1203,1202,12013,12012,12010,12008,12007,12004,12003,1197,11971,1193,1189,11877,11876,1181,11796,1177,11751,1172,11723,11720,1171,1170,11623,1161,1160,11600,1155,11489,1146,11430,1142,1140,11367,1133,11321,11320,11319,1129,11211,1120,11208,11202,11201,11175,11174,11173,11172,11171,11165,11164,11163,11162,11161,1115,11112,11109,11108,11106,11105,11104,11103,11095,10990,10933,10880,10860,10810,10809,10805,10800,107,10631,105,10548,10544,10543,10542,10541,10540,10439,10321,10288,10261,10260,10253,10252,10201,10200,10162,10161,10129,10128,10125,10117,10116,10114,10113,10111,10110,10107,10104,10103,10102,10100,10081,10080,10055,10051,10050]

TIMEOUT = 2

parser = argparse.ArgumentParser("./pmap.py")
parser.add_argument('host', metavar='HOST', type=str, nargs='+', help='The host to scan')
parser.add_argument("-t", "--top", action="store", default=None, help="Top X highest-ratio tcp ports")
parser.add_argument("-p","--ports",action="store", default=None, help="Specify comma seperated ports (22,80) or port ranges using hyphen (25-30)")
parser.add_argument("-c","--count",action="store", default=None, help="Upper limit for concurrent threads of execution")
parsed = parser.parse_args()

TOP = parsed.__getattribute__("top")
hosts = []
host_arg = parsed.__getattribute__("host")[0]

while True:
    try:
        socket.inet_aton(host_arg)  # single ip passed
        hosts.append(host_arg)
        break
    except:
        pass

    try:
        network = ipaddress.ip_network(host_arg)  # CIDR notation
        for i in network:
            add = str(i)
            hosts.append(add)
        break
    except:
        pass

    try:
        resolved = socket.gethostbyname(host_arg)   # single domain name
        hosts.append(resolved)
        break
    except:
        try:                                    # domain + cidr notation
            domain = host_arg.split("/")[0]
            cidr = host_arg.split("/")[1]
            resolved = socket.gethostbyname(domain)

            keep_octets = int(int(cidr)/8)
            resolved = resolved.split(".")[:keep_octets]
            
            for i in range(4-keep_octets):
                resolved.append("0")
            
            resolved = ".".join(resolved)
            network = ipaddress.ip_network(resolved + "/" + cidr)

            for i in network:
                add = str(i)
                hosts.append(add)
            break
        except:
            print("Invalid host specification!")
            exit()


scan_ports = parsed.__getattribute__("ports")
thread_count = parsed.__getattribute__("count")

def format_array(arr):
    result = []
    for i in arr:
        if (i not in result) and i != "":
            result.append(i)
    return result

def to_int(arr):
    result = []
    for i in arr:
        result.append(int(i))
    return result

if thread_count:
    try:
        threads = int(thread_count)
    except:
        exit()
else:
    threads = 50

if TOP != None and scan_ports != None:
    print("Top ports and regular port spesifications cannot be used together!")
    exit()

if TOP:
    scan = PORTS[:int(TOP)]

if scan == None and scan_ports:
    result = []
    splitted = scan_ports.split(",")
    splitted = format_array(splitted)
    for i in splitted:
        if "-" in i:
            port_range = i.split("-")
            if (len(port_range) != 2) or port_range[0] == "" or port_range[1] == "":
                print("Invalid port range specification:",i)
                exit()
            else:
                try:
                    start_port = int(port_range[0])
                    end_port = int(port_range[1])
                    if (start_port < 0 or start_port > 65535) or (end_port < 0 or end_port > 65535):
                        print("Invalid port range specification:",i)
                    result += list(range(start_port,end_port+1))
                except ValueError:
                    print("Invalid port range specification:",i)
                    exit()
        else:
            try:
                if int(i) < 0 or int(i) > 65535:
                    print("Invalid port number:", i)
                    exit()
                result.append(i)
            except ValueError:
                print("Invalid port number:", i)
                exit()

    scan = format_array(result)
    scan = to_int(scan)

try:
    if scan:
        pass
except NameError:
    print("There is no port spesification!")
    exit()

### SO FAR SO GOOD ###

class Open:
    def __init__(self):
        self.ports = []
        self.progress = 0

class Host:
    def __init__(self):
        self.ip = ""
        self.open = Open()

def scan_port(port, obj: Open, host):
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    socket.setdefaulttimeout(TIMEOUT)
    s.settimeout(TIMEOUT)
    if s.connect_ex((host,port)) == 0:
        obj.ports.append(port)
    obj.progress += 1

host_list = []


now = datetime.datetime.now()
print(colored("="*45,"blue",attrs=["bold"]))
print("Starting the scan: " + str(now))
print("Targets:", host_arg)
print(colored("="*45,"blue",attrs=["bold"]))
print()
start = time.time()

progress_str = colored("=> ","blue",attrs=["bold"])

scan_ports = scan
port_count = len(scan_ports)
host_count = len(hosts)

for host in hosts:
    host_obj = Host()
    host_obj.ip = host
    host_list.append(host_obj)

    for i in scan:
        while True:
            if threading.active_count() > threads:
                time.sleep(0.2)
            else:
                threading.Thread(target=scan_port, args=(i,host_obj.open,host)).start()
                break
        
        if host_count == 1:
            print("\r" + progress_str + "Progress: " + str(int(int((host_obj.open.progress)/(port_count*host_count) * 100))) + " % ", end="")
        elif len(host_list) == host_count:
            print("\r" + progress_str + "Progress: " + str(int(int((len(host_list)*port_count)/(port_count*host_count) * 100))) + " % ", end="")
        else:
            print("\r" + progress_str + "Progress: " + str(int(int((len(host_list)*port_count + host_obj.open.progress)/(port_count*host_count) * 100))) + " % ", end="")
        # print("\r" + progress_str + "Progress: " + str(int((host_obj.open.progress / float(len(scan))) * 10000)/100.0) + " % ", end="")

    while True:
        if threading.active_count() == 1:
            if host_count == 1:
                print("\r" + progress_str + "Progress: " + str(int(int((host_obj.open.progress)/(port_count*host_count) * 100))) + " % ", end="")
            elif len(host_list) == host_count:
                print("\r" + progress_str + "Progress: " + str(int(int((len(host_list)*port_count)/(port_count*host_count) * 100))) + " % ", end="")
            else:
                print("\r" + progress_str + "Progress: " + str(int(int((len(host_list)*port_count + host_obj.open.progress)/(port_count*host_count) * 100))) + " % ", end="")
            break
        else:
            if host_count == 1:
                print("\r" + progress_str + "Progress: " + str(int(int((host_obj.open.progress)/(port_count*host_count) * 100))) + " % ", end="")
            elif len(host_list) == host_count:
                print("\r" + progress_str + "Progress: " + str(int(int((len(host_list)*port_count)/(port_count*host_count) * 100))) + " % ", end="")
            else:
                print("\r" + progress_str + "Progress: " + str(int(int((len(host_list)*port_count + host_obj.open.progress)/(port_count*host_count) * 100))) + " % ", end="")
            time.sleep(0.1)


print()
print()

for i in host_list:
    print(i.ip)
    print("="*len(i.ip))
    for j in i.open.ports:
        print(colored(str(j).ljust(8) + " OPEN","green",attrs=["bold"]))
    print()
    print()


exec_time = time.time() - start
exec_time = int(exec_time*100)/100.0
print(colored("[*]", "blue",attrs=["bold"]), len(scan), "port(s) scanned in " + str(host_count) + " host(s)")
print(colored("[*]", "blue",attrs=["bold"]),"Time elapsed:", exec_time, "seconds")
